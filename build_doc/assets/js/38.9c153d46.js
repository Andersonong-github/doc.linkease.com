(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{607:function(a,e,t){a.exports=t.p+"assets/img/nas.514fa6c1.jpg"},857:function(a,e,t){"use strict";t.r(e);var s=t(47),r=Object(s.a)({},(function(){var a=this,e=a.$createElement,s=a._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"构建固件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#构建固件"}},[a._v("#")]),a._v(" 构建固件")]),a._v(" "),s("p",[s("strong",[a._v("建议有动手能力的伙伴们去自行DIY，也可以直接用官方提供的稳定固件。")])]),a._v(" "),s("p",[a._v("自定义OpenWrt固件，先去开源地址："),s("a",{attrs:{href:"https://firmware.koolshare.cn/binary/ars2/",target:"_blank",rel:"noopener noreferrer"}},[a._v("ImageBuilder+SDK"),s("OutboundLink")],1),a._v(" 下载ImageBuilder和SDK。")]),a._v(" "),s("p",[a._v("1.准备好安装Debian10 x64或者ubuntu等Linux发行版的电脑或虚拟机；")]),a._v(" "),s("p",[a._v("2.安装必要软件；")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("sudo -E apt-get update\nsudo -E apt-get install build-essential asciidoc binutils bzip2 gawk gettext git libncurses5-dev libz-dev patch unzip zlib1g-dev lib32gcc1 libc6-dev-i386 subversion flex uglifyjs gcc-multilib g++-multilib p7zip p7zip-full msmtp libssl-dev texinfo libglib2.0-dev xmlto qemu-utils upx libelf-dev autoconf automake libtool autopoint device-tree-compiler antlr3 gperf\n")])])]),s("p",[a._v("3.将ImageBuilder解压到非中文目录；")]),a._v(" "),s("p",[a._v("4.进入ImageBuilder，执行：")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("make image PROFILE=ars2\n")])])]),s("p",[a._v("5.成功的话会在bin/targets/realtek/rtd129x/下生成*.install.img固件。")]),a._v(" "),s("h4",{attrs:{id:"扩展说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#扩展说明"}},[a._v("#")]),a._v(" 扩展说明")]),a._v(" "),s("p",[a._v("1.如果需要控制打包到固件中的软件包，可以在make image时使用PACKAGES参数，例如想要增加luci-app-passwall，并删除luci-app-ttyd，则执行：")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('make image PROFILE=ars2 PACKAGES="luci-app-passwall -luci-app-ttyd -luci-i18n-ttyd-zh-cn"\n')])])]),s("p",[a._v("2.默认的软件源只有ImageBuilder内置的，如果需要增加外部的软件源，可编辑ImageBuilder里的repositories.conf，例如增加Openwrt官方的软件源，则repositories.conf的内容如下:")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("src/gz openwrt_base http://downloads.openwrt.org/releases/19.07.7/packages/aarch64_cortex-a53/base\n\nsrc/gz openwrt_packages http://downloads.openwrt.org/releases/19.07.7/packages/aarch64_cortex-a53/packages\n\nsrc/gz openwrt_routing http://downloads.openwrt.org/releases/19.07.7/packages/aarch64_cortex-a53/routing\n\n\nsrc imagebuilder file:packages\n")])])]),s("p",[a._v("3.如果需要增加本地的软件源，则增加一行:src custom file:///usr/src/openwrt/bin/realtek/packages，例如增加已经编译好的lean的软件源(不要使用core和luci仓库，以免冲突):")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("src lean_base file:///home/build/lean-openwrt/bin/packages/aarch64_cortex-a53/base\n")])])]),s("h2",{attrs:{id:"编译插件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#编译插件"}},[a._v("#")]),a._v(" 编译插件")]),a._v(" "),s("p",[a._v("1.将SDK解压到非中文目录；")]),a._v(" "),s("p",[a._v("2.进入SDK目录，可以在feeds.conf.default文件内加入自定义插件源：")]),a._v(" "),s("p",[a._v("比如加入：")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("src-git nas https://github.com/linkease/nas-packages.git;master\n")])])]),s("p",[s("img",{attrs:{src:t(607),alt:"img"}})]),a._v(" "),s("p",[a._v("3.然后执行；")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("./scripts/feeds update -a\n\n./scripts/feeds install -a\n\nmake menuconfig\n")])])]),s("p",[a._v("执行过程中会弹出menuconfig配置界面，选择配置好要编译的插件；")]),a._v(" "),s("p",[a._v("4.再执行：")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("make -j8 download V=s  ##下载dl库(科学上网)\n")])])]),s("p",[a._v("5.可以执行编译命令直接编译插件。")]),a._v(" "),s("p",[a._v("比如编译：")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("make package/feeds/nas/luci-app-ddnsto/compile V=99\n")])])])])}),[],!1,null,null,null);e.default=r.exports}}]);